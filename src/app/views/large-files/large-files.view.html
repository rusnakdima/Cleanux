<app-header [title]="'Large Files (> 100MB)'"></app-header>

<div class="p-6 space-y-6 max-w-7xl mx-auto flex-1 overflow-auto">
  <!-- Summary Cards -->
  <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
    <div class="glass-card p-8 flex items-center gap-6">
      <div class="w-16 h-16 rounded-2xl bg-indigo-500/10 flex items-center justify-center">
        <mat-icon class="text-indigo-500 text-3xl">file_copy</mat-icon>
      </div>
      <div>
        <p class="text-xs font-bold text-slate-500 dark:text-slate-400 uppercase tracking-widest">
          Large Files Found
        </p>
        <p class="text-4xl font-black text-slate-900 dark:text-white">{{ largeFiles().length }}</p>
      </div>
    </div>

    <div class="glass-card p-8 flex items-center gap-6">
      <div class="w-16 h-16 rounded-2xl bg-pink-500/10 flex items-center justify-center">
        <mat-icon class="text-pink-500 text-3xl">storage</mat-icon>
      </div>
      <div>
        <p class="text-xs font-bold text-slate-500 dark:text-slate-400 uppercase tracking-widest">
          Total Space
        </p>
        <p class="text-4xl font-black text-slate-900 dark:text-white">
          {{ formatSize(totalSize()) }}
        </p>
      </div>
    </div>
  </div>

  <div class="glass-card flex flex-col h-[calc(100vh-280px)] overflow-hidden">
    <div
      class="flex items-center justify-between px-6 py-4 border-b border-slate-100 dark:border-slate-800"
    >
      <div class="flex items-center gap-4">
        <app-search
          [data]="largeFiles()"
          [searchFields]="['name', 'path']"
          (filteredData)="onFilteredData($event)"
        />
        <button
          (click)="loadData()"
          class="p-2 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors"
          matTooltip="Refresh"
        >
          <mat-icon>refresh</mat-icon>
        </button>
      </div>
      <button
        (click)="clearSelectedFiles()"
        [disabled]="selectedFiles().size === 0"
        class="px-4 py-2 bg-red-600 hover:bg-red-700 disabled:bg-slate-400 text-white rounded-lg font-medium transition-colors flex items-center gap-2"
      >
        <mat-icon class="text-sm">delete</mat-icon>
        Delete Selected
      </button>
    </div>
    <div class="flex-1 p-6 overflow-hidden">
      <app-data-table
        [columns]="columns"
        [data]="filteredFiles()"
        [loading]="loading()"
        [options]="getTableOptions()"
        [selectedKeys]="selectedFiles()"
        (selectionChange)="selectedFiles.set($event)"
        (preview)="onPreview($event)"
      />
    </div>
  </div>
</div>

@if (previewData()) {
  <app-file-preview
    [fileData]="previewData()"
    (close)="onClosePreview()"
    (openInEditor)="onOpenInEditor($event)"
  />
}
